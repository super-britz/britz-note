# http protocol

## 浏览器行为与HTTP协议

简单的处理流程：

1. 首先用户向浏览器发指令，例如www.google.com
2. 然后浏览器首先要测试网络连通性，可能是路由器、网关、防火墙，接着dns解析, 拿到ip地址
4. 浏览器发送http请求，底层是路由策略，中继站（路由器），去的时候的路和回来的路可能不一样
5. 请求到一个ip地址，可能是集群有多个服务器，找到提供服务的服务器
6. 服务器处理请求，返回html响应
7. 浏览器处理html页面
8. 继续请求其他资源

加速器把一些线路短路掉，绕过一些障碍

## 什么http协议

HTTP（Hyper Text Transfer Protocol）是超文本传输协议，从www服务器传输到本地浏览器的一种传输协议，网站是基于HTTP协议的，例如网站的图片、CSS、JS等都是基于 HTTP协议进行传输的。

HTTP协议是由从客户机到服务器的请求(Request)和从服务器到客户机 的响应(response)进行约束和规范。

![http请求模型](../../../images/live/week_second/http-model.webp)


#### 了解TCP/IP协议栈

TCP/IP 协议模型

1. 应用层: 为用户提供所需要的各种服务，例如:HTTP、FTP、DNS、SMTP等.
2. 传输层: 为应用层实体提供端到端的通信功能，保证数据包的顺序传送及数据的完整性。
该层定义了两个主要的协议:传输控制协议(TCP)和用户数据报协 议(UDP).
3. 网络层: 主要解决主机到主机的通信问题。IP协议是网际互联层最重要的协 议。
4. 网络接口层: 负责监视数据在主机和网络之间的交换

![http请求模型](../../../images/live/week_second/osi-tcp.png)

ISO 协议模型

1. 物理层：网线、无线电波wifi、4G
2. 数据链路层：网卡
3. 网络层：解决从主机到主机最基础的通信问题 `ping www.google.com` 数据报协议
4. 传输层：TCP可靠， UPD不可靠，各有优点
5. 会话层：维持通信状态
6. 表示层：数据处理
7. 应用层：提供接口

一般不能跨层，ping 相当于工具

#### HTTP 在 TCP/IP协议栈中的位置

在应用层偏底层这一块加上 TLS、SSL

#### http2 vs http1.1 https

* http 默认端口 80
* https 默认端口 443
* http2 默认端口 443

#### http 的工作过程

一次HTTP操作称为一个事务，其工作过程可分为四步，只要一步失败，http请求失败

1. 首先客户机与服务器建立 TCP 连接
2. 建立连接后，客户机发送一个请求给服务器
3. 服务器接到请求后，给予相应的响应信息
4. 客户端接收服务器所返回的信息，然后客户机与服务器断开连接

如果在以上过程中的某一步出现错误，那么产生错误的信息将返回到客户端

#### 请求和响应

* HTTP请求组成:请求行、消息报头、请求正文。 
* HTTP响应组成:状态行、消息报头、响应正文。 
* 请求行组成:以一个方法符号开头，后面跟着请求的URI和协议的版本。
* 状态行组成:服务器HTTP协议的版本，服务器发回的响应状态代码和状 态代码的文本描述。

![http请求模型](../../../images/live/week_second/http-request.png)
![http请求模型](../../../images/live/week_second/http-response.png)

#### HTTP首部字段

HTTP首部字段根据实际通途被分为以下4种类型：

- 通用首部字段（General Header Fileds）：请求报文和响应报文两方都会使用的首部
- 请求首都字段（Request Header Fields）：从客服端向服务器端发送请求报文时使用的首部。
- 响应首部字段（Response Header Fields）：从服务器端向客户端返回响应报文时使用的首部。
- 实体首部字段（Entity Header Fields）：针对请求报文和响应报文的实体部分使用的首部。

#### 